!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r(require("@ecomplus/utils"),require("core-js/modules/es.symbol.js"),require("core-js/modules/es.object.keys.js"),require("core-js/modules/es.array.filter.js"),require("core-js/modules/es.object.get-own-property-descriptor.js"),require("core-js/modules/web.dom-collections.for-each.js"),require("core-js/modules/es.object.get-own-property-descriptors.js"),require("core-js/modules/es.string.replace.js"),require("core-js/modules/es.regexp.exec.js"),require("core-js/modules/es.object.to-string.js"),require("core-js/modules/es.symbol.description.js"),require("core-js/modules/es.symbol.iterator.js"),require("core-js/modules/es.string.iterator.js"),require("core-js/modules/es.array.iterator.js"),require("core-js/modules/web.dom-collections.iterator.js"),require("core-js/modules/es.string.starts-with.js"),require("axios"),require("core-js/modules/es.array.concat.js"),require("core-js/modules/es.promise.js"),require("core-js/modules/es.promise.finally.js"),require("core-js/modules/es.array.index-of.js"),require("core-js/modules/es.array.splice.js"),require("core-js/modules/es.array.slice.js")):"function"==typeof define&&define.amd?define([,"core-js/modules/es.symbol.js","core-js/modules/es.object.keys.js","core-js/modules/es.array.filter.js","core-js/modules/es.object.get-own-property-descriptor.js","core-js/modules/web.dom-collections.for-each.js","core-js/modules/es.object.get-own-property-descriptors.js","core-js/modules/es.string.replace.js","core-js/modules/es.regexp.exec.js","core-js/modules/es.object.to-string.js","core-js/modules/es.symbol.description.js","core-js/modules/es.symbol.iterator.js","core-js/modules/es.string.iterator.js","core-js/modules/es.array.iterator.js","core-js/modules/web.dom-collections.iterator.js","core-js/modules/es.string.starts-with.js","axios","core-js/modules/es.array.concat.js","core-js/modules/es.promise.js","core-js/modules/es.promise.finally.js","core-js/modules/es.array.index-of.js","core-js/modules/es.array.splice.js","core-js/modules/es.array.slice.js"],r):"object"==typeof exports?exports.ecomClient=r(require("@ecomplus/utils"),require("core-js/modules/es.symbol.js"),require("core-js/modules/es.object.keys.js"),require("core-js/modules/es.array.filter.js"),require("core-js/modules/es.object.get-own-property-descriptor.js"),require("core-js/modules/web.dom-collections.for-each.js"),require("core-js/modules/es.object.get-own-property-descriptors.js"),require("core-js/modules/es.string.replace.js"),require("core-js/modules/es.regexp.exec.js"),require("core-js/modules/es.object.to-string.js"),require("core-js/modules/es.symbol.description.js"),require("core-js/modules/es.symbol.iterator.js"),require("core-js/modules/es.string.iterator.js"),require("core-js/modules/es.array.iterator.js"),require("core-js/modules/web.dom-collections.iterator.js"),require("core-js/modules/es.string.starts-with.js"),require("axios"),require("core-js/modules/es.array.concat.js"),require("core-js/modules/es.promise.js"),require("core-js/modules/es.promise.finally.js"),require("core-js/modules/es.array.index-of.js"),require("core-js/modules/es.array.splice.js"),require("core-js/modules/es.array.slice.js")):e.ecomClient=r(e.ecomUtils,e["core-js/modules/es.symbol.js"],e["core-js/modules/es.object.keys.js"],e["core-js/modules/es.array.filter.js"],e["core-js/modules/es.object.get-own-property-descriptor.js"],e["core-js/modules/web.dom-collections.for-each.js"],e["core-js/modules/es.object.get-own-property-descriptors.js"],e["core-js/modules/es.string.replace.js"],e["core-js/modules/es.regexp.exec.js"],e["core-js/modules/es.object.to-string.js"],e["core-js/modules/es.symbol.description.js"],e["core-js/modules/es.symbol.iterator.js"],e["core-js/modules/es.string.iterator.js"],e["core-js/modules/es.array.iterator.js"],e["core-js/modules/web.dom-collections.iterator.js"],e["core-js/modules/es.string.starts-with.js"],e.axios,e["core-js/modules/es.array.concat.js"],e["core-js/modules/es.promise.js"],e["core-js/modules/es.promise.finally.js"],e["core-js/modules/es.array.index-of.js"],e["core-js/modules/es.array.splice.js"],e["core-js/modules/es.array.slice.js"])}(this,(function(e,r,t,o,s,n,c,i,u,a,l,f,p,j,d,m,b,y,O,g,h,v,w){return function(e){var r={};function t(o){if(r[o])return r[o].exports;var s=r[o]={i:o,l:!1,exports:{}};return e[o].call(s.exports,s,s.exports,t),s.l=!0,s.exports}return t.m=e,t.c=r,t.d=function(e,r,o){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var s in e)t.d(o,s,function(r){return e[r]}.bind(null,s));return o},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=26)}([function(r,t){r.exports=e},function(e,r,t){"use strict";(function(e){t(2),t(12),t(11),t(13),t(14),t(15),t(16);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r.a="object"===("undefined"==typeof window?"undefined":o(window))&&window||"object"===(void 0===e?"undefined":o(e))&&e&&e.env||{}}).call(this,t(19))},function(e,t){e.exports=r},function(e,r){e.exports=t},function(e,r){e.exports=o},function(e,r){e.exports=s},function(e,r){e.exports=n},function(e,r){e.exports=c},function(e){e.exports=JSON.parse('{"a":"@ecomplus/client","b":"2.2.1"}')},function(e,r){e.exports=i},function(e,r){e.exports=u},function(e,r){e.exports=a},function(e,r){e.exports=l},function(e,r){e.exports=f},function(e,r){e.exports=p},function(e,r){e.exports=j},function(e,r){e.exports=d},function(e,r){e.exports=m},function(e,r){e.exports=b},function(e,r){var t,o,s=e.exports={};function n(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===n||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:n}catch(e){t=n}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(e){o=c}}();var u,a=[],l=!1,f=-1;function p(){l&&u&&(l=!1,u.length?a=u.concat(a):f=-1,a.length&&j())}function j(){if(!l){var e=i(p);l=!0;for(var r=a.length;r;){for(u=a,a=[];++f<r;)u&&u[f].run();f=-1,r=a.length}u=null,l=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(r){try{return o.call(null,e)}catch(r){return o.call(this,e)}}}(e)}}function d(e,r){this.fun=e,this.array=r}function m(){}s.nextTick=function(e){var r=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)r[t-1]=arguments[t];a.push(new d(e,r)),1!==a.length||l||i(j)},d.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(e){return[]},s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(e,r){e.exports=y},function(e,r){e.exports=O},function(e,r){e.exports=g},function(e,r){e.exports=h},function(e,r){e.exports=v},function(e,r){e.exports=w},function(e,r,t){"use strict";t.r(r),t.d(r,"_self",(function(){return n})),t.d(r,"store",(function(){return A})),t.d(r,"platform",(function(){return N})),t.d(r,"search",(function(){return $})),t.d(r,"graphs",(function(){return B})),t.d(r,"modules",(function(){return Q})),t.d(r,"passport",(function(){return ee})),t.d(r,"storefront",(function(){return se}));var o={};t.r(o),t.d(o,"_self",(function(){return n})),t.d(o,"store",(function(){return A})),t.d(o,"platform",(function(){return N})),t.d(o,"search",(function(){return $})),t.d(o,"graphs",(function(){return B})),t.d(o,"modules",(function(){return Q})),t.d(o,"passport",(function(){return ee})),t.d(o,"storefront",(function(){return se}));var s=t(8),n=s.a+"@"+s.b,c=(t(9),t(10),t(3),t(2),t(4),t(5),t(6),t(7),t(0)),i=(t(12),t(11),t(13),t(14),t(15),t(16),t(1));function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var a=Boolean("object"===("undefined"==typeof window?"undefined":u(window))&&null!==window&&window.document),l=i.a.ECOMCLIENT_API_STORE||"https://api.e-com.plus/v1/",f=i.a.ECOMCLIENT_API_STORE_CACHE||"https://ioapi.ecvol.com/:id/v1/",p=i.a.ECOMCLIENT_API_PASSPORT||"https://passport.e-com.plus/v1/",j=i.a.ECOMCLIENT_API_SEARCH||"https://apx-search.e-com.plus/api/v1/",d=i.a.ECOMCLIENT_API_MODULES||"https://apx-mods.e-com.plus/api/v1/",m=i.a.ECOMCLIENT_API_STOREFRONT||"https://iostorefront.ecvol.com/api/v1/",b=i.a.ECOMCLIENT_API_GRAPHS||"https://apx-graphs.e-com.plus/api/v1/",y=i.a.ECOMCLIENT_API_PLATFORM||"https://e-com.plus/api/v1/",O=i.a.ECOMCLIENT_API_PLATFORM_CACHE||"https://io.ecvol.com/api/v1/",g=(t(20),t(21),t(22),t(23),t(24),t(17),t(25),t(18)),h=t.n(g).a.create({timeout:6e4});h.defaults.headers||(h.defaults.headers={});var v=h.defaults.headers;["post","patch","put"].forEach((function(e){v[e]||(v[e]={}),v[e]["Content-Type"]="application/json"}));var w=h,P={};P[l]=P[d]=P[y]=250,P[m]=400,P[b]=570,P[p]=1070;var x={},E=0,q=[],T=function(e){return!0===i.a[e]||"true"===i.a[e]},_=T("ECOMCLIENT_DEBUG"),C=function(e){var r=e.url,t=e.method,o=e.baseURL,s=e.timeout;-1===r.indexOf(".json")&&(e.url=r.replace(/^([^?]+)(\?.*)?$/,"$1.json$2"));var n,c,i=w.getUri(e);for(n in i.startsWith("http")||("/"===o.slice(-1)&&"/"===i.charAt(0)&&(i=i.substr(1)),i=o+i),_&&console.log("[ecomClient]: ".concat(t&&t.toUpperCase()||"GET"," '").concat(i,"'")),P)if(void 0!==P[n]&&0===i.indexOf(n)){c=P[n];break}c||(c=50);var u=x[n]||0;return x[n]=u+1,new Promise((function(r,t){var o=0;!function i(){var a,l=c*u+2.5*E;_&&(a=Date.now(),console.log("[ecomClient]: (".concat(a,") request delay ").concat(l,"ms"))),setTimeout((function(){q.indexOf(n)<=-1?(x[n]--,function(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:170,o=arguments.length>3?arguments[3]:void 0;return _&&console.log("[ecomClient]: (".concat(o," ~ ").concat(Date.now(),") send ").concat(e.method," ").concat(e.url)),T("ECOMCLIENT_NOTIMEOUT")&&e.timeout&&(e.timeout=0),new Promise((function(o,s){E++,w.request(e).then(o).catch((function(n){_&&(n.message="[ecomClient]: ".concat(n.message),console.error(n));var c=n.response;if(c&&503===c.status)return r&&q.push(r),setTimeout((function(){if(r){var t=q.indexOf(r);t>-1&&q.splice(t,1)}w.request(e).then(o).catch(s)}),t>=170?t:170);s(n)})).finally((function(){E--}))}))}(e,n,c,a).then(r).catch((function(e){if(!s&&o<2&&e.response&&e.response.status>=500)return setTimeout(i,Math.max(c,600)),o++;t(e)}))):i()}),l)}()}))};function S(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function D(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?S(Object(t),!0).forEach((function(r){I(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):S(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function I(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var L=!0,A=function e(r){var t,o,s,n=r.url,i=r.authenticationId,u=r.accessToken,p=r.method,j=void 0===p?"get":p,d=r.data,m=r.storeId,b=void 0===m?c._config.get("store_id"):m,y=r.axiosConfig;return"get"!==j.toLowerCase()||i?(o=l,s={"X-Store-ID":b,"X-My-ID":i,"X-Access-Token":u}):!L||/\?/.test(n)||y&&y.params?(t=a?5e3:3e4,o=l,s={"X-Store-ID":b}):(t=a?2500:1e4,o=f.replace(":id",b)),C(D(D({data:d,timeout:t},y),{},{url:n,baseURL:o,method:j,headers:s})).catch((function(r){var t=r.response;if(t&&o===f){var s=t.status;if(!s||s<100||s>=500)return L=!1,setTimeout((function(){L=!0}),3e4),e(n)}throw r}))};function M(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function k(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?M(Object(t),!0).forEach((function(r){R(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):M(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function R(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var N=function e(r){var t,o,s=r.url,n=r.storeId,i=(void 0===n&&c._config.get("store_id"),r.axiosConfig);return/\?/.test(s)||i&&i.params?(t=a?5e3:3e4,o=y):(t=2500,o=O),C(k(k({timeout:t},i),{},{url:s,baseURL:o})).catch((function(r){var t=r.response;if(t&&o===O){var n=t.status;if(!n||n<100||n>=500)return e(s)}throw r}))};function U(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function X(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?U(Object(t),!0).forEach((function(r){H(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):U(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function H(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var $=function(e){var r=e.url,t=e.method,o=void 0===t?"get":t,s=e.data,n=e.storeId,i=void 0===n?c._config.get("store_id"):n,u=e.axiosConfig;return C(X(X({data:s,timeout:a?1e4:3e4},u),{},{url:r,baseURL:j,method:o,headers:{"X-Store-ID":i}}))};function F(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function G(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?F(Object(t),!0).forEach((function(r){W(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):F(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function W(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var B=function(e){var r=e.url,t=e.storeId,o=void 0===t?c._config.get("store_id"):t,s=e.axiosConfig;return C(G(G({timeout:a?5e3:3e4},s),{},{url:r,baseURL:b,headers:{"X-Store-ID":o}}))};function J(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function z(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?J(Object(t),!0).forEach((function(r){K(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):J(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function K(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var Q=function(e){var r=e.url,t=e.method,o=void 0===t?"get":t,s=e.data,n=e.storeId,i=void 0===n?c._config.get("store_id"):n,u=e.axiosConfig;return C(z(z({data:s},u),{},{url:r,baseURL:d,method:o,headers:{"X-Store-ID":i}}))};function V(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function Y(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?V(Object(t),!0).forEach((function(r){Z(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):V(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function Z(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var ee=function(e){var r,t=e.url,o=e.customerId,s=e.accessToken,n=e.method,i=void 0===n?"get":n,u=e.data,a=e.storeId,l=void 0===a?c._config.get("store_id"):a,f=e.axiosConfig,j=p;return t.startsWith("http")||t.startsWith("/"+l)||(j+=l),o&&s&&(r={"X-My-ID":o,"X-Access-Token":s}),C(Y(Y({data:u},f),{},{url:t,baseURL:j,method:i,headers:r}))};function re(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function te(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?re(Object(t),!0).forEach((function(r){oe(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):re(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function oe(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var se=function(e){var r=e.url,t=e.storeId,o=void 0===t?c._config.get("store_id"):t,s=e.axiosConfig;return"/"===r.charAt(0)&&(r=r.substr(1)),!/^\/?[0-9]+@?/.test(r)&&o&&(r=o+"@"+r),r="/"+r.replace(/\//g,"$"),C(te(te({timeout:a?5e3:3e4},s),{},{url:r,baseURL:m}))};r.default=o}])}));
//# sourceMappingURL=ecom-client.min.js.map